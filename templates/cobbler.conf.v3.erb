# This configuration file allows cobbler data
# to be accessed over HTTP.
<IfModule !wsgi_module>
    LoadModule wsgi_module /usr/lib64/httpd/modules/mod_wsgi_python3.so
</IfModule>
<IfModule !proxy_module>
    LoadModule proxy_module /usr/lib64/httpd/modules/mod_proxy.so
</IfModule>
<IfModule !proxy_http_module>
    LoadModule proxy_http_module /usr/lib64/httpd/modules/mod_proxy_http.so
</IfModule>

AliasMatch ^/cblr(?!/svc/)(.*)?$ "<%= @webroot %>$1"
AliasMatch ^/cobbler_track(.*)?$ "<%= @webroot %>$1"
#AliasMatch ^/cobbler(.*)?$ "<%= @webroot %>$1"
Alias /cobbler <%= @webroot %>

Alias /httpboot /var/lib/tftpboot/grub
Alias /images /var/lib/tftpboot/grub/images

WSGIScriptAliasMatch ^/cblr/svc/([^/]*) <%= @webroot -%>/svc/services.py

<VirtualHost *:80>

<Directory "<%= @webroot %>">
    SetEnv VIRTUALENV
    Options Indexes FollowSymLinks
    Require all granted
</Directory>

<Directory /var/lib/tftpboot/grub>
        Options Indexes FollowSymLinks
        AllowOverride None
        AuthType None
        Require all granted
</Directory>

ProxyRequests off

ProxyPass /cobbler_api http://localhost:25151/
ProxyPassReverse /cobbler_api http://localhost:25151/

BrowserMatch "MSIE" AuthDigestEnableQueryStringHack=On

<Location /cblr>
    Require all granted
</Location>

</VirtualHost>
